name: Update Date Badge
on:
  push:
    branches:
      - master
jobs:
  update-badge:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Generate Badge JSON
        run: |
          # 1. Calculate Dates
          CREATED=$(git log --diff-filter=A --follow --format=%ad --date=format:'%b %d, %Y' -- README.md | tail -1)
          UPDATED=$(git log -1 --format=%ad --date=format:'%b %d, %Y' -- README.md)

          # 2. Create JSON file for Shields.io
          # We save it to a folder named 'badges'
          mkdir -p badges
          echo "{ \"schemaVersion\": 1, \"label\": \"README\", \"message\": \"Created: $CREATED | Updated: $UPDATED\", \"color\": \"blue\" }" > badges/dates.json

      - name: Deploy to Badges Branch
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: badges # Pushes to a branch named 'badges'
          folder: badges # Pushes the contents of the 'badges' folder
